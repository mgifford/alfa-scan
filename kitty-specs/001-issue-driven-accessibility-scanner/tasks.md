# Work Packages: Issue-Driven Accessibility Scanner

**Inputs**: Design documents from `/kitty-specs/001-issue-driven-accessibility-scanner/`  
**Prerequisites**: plan.md (required), spec.md (user stories), research.md, data-model.md, contracts/, quickstart.md

**Tests**: Include unit/integration/e2e validation because this feature has explicit measurable outcomes and operational constraints.

**Organization**: Fine-grained subtasks (`Txxx`) roll up into work packages (`WPxx`). Each work package is independently deliverable and testable.

**Prompt Files**: Each work package references a matching prompt file in `/tasks/` generated by `/spec-kitty.tasks`. Treat this file as the high-level checklist.

## Subtask Format: `[Txxx] [P?] Description`

- **[P]** indicates the subtask can proceed in parallel (different files/components).
- Include precise file paths or modules.

## Path Conventions

- Root automation and workflows: `.github/workflows/`, `scanner/`, `reports/`
- Static intake UI: `pages/`
- Tests: `tests/unit/`, `tests/integration/`, `tests/e2e/`

---

## Work Package WP01: Foundation and Guardrails (Priority: P0)

**Goal**: Establish baseline project scaffolding, payload schema, URL safety utilities, and workflow shell.
**Independent Test**: A sample scan issue payload validates successfully; invalid/private URLs are rejected by shared validation; workflow dry run executes parser stage.
**Prompt**: `/tasks/WP01-foundation-and-guardrails.md`

### Included Subtasks

- [x] T001 Initialize scanner project structure and package scripts in `scanner/` and `tests/`.
- [x] T002 Define canonical scan request schema and parser contract for issue body extraction.
- [x] T003 Implement reusable URL validation and private/internal address blocking utility.
- [x] T004 Create baseline GitHub Actions workflow skeleton with required permissions and concurrency settings.
- [x] T005 Add unit tests for schema parsing and URL validation guardrails.

### Implementation Notes

- Deliver shared primitives first so downstream WPs can consume stable interfaces.
- Keep URL validation centralized to avoid policy drift across workflows and form logic.

### Parallel Opportunities

- T003 and T004 can run in parallel after T002 contract is defined.

### Dependencies

- None (starting package).

### Risks & Mitigations

- Risk: schema mismatch between intake and workflow parser.
- Mitigation: lock parser tests to fixture-based issue payloads in this WP.

---

## Work Package WP02: GitHub Pages Intake and Issue Submission (Priority: P1) ðŸŽ¯ MVP

**Goal**: Provide a GitHub Pages form that accepts up to 100 URLs and creates a structured authenticated issue request.
**Independent Test**: Authenticated user submits valid URL batch from Pages and a correctly formatted scan issue is created.
**Prompt**: `/tasks/WP02-pages-intake-and-issue-submission.md`

### Included Subtasks

- [ ] T006 Build Pages form UI in `pages/index.html` and `pages/submit.js` supporting line and CSV input.
- [ ] T007 Implement client-side normalization and max-100 validation with actionable error messages.
- [ ] T008 Integrate GitHub-authenticated issue creation flow and structured issue body generation.
- [ ] T009 Add client-side handling for malformed URLs and preview of accepted/rejected lines.
- [ ] T010 Add integration tests/fixtures for issue payload composition from mixed input.

### Implementation Notes

- Reuse schema/formatter definitions from WP01 to keep form output compatible with workflow parser.
- Ensure the intake path does not imply direct scanning from Pages runtime.

### Parallel Opportunities

- T009 can run in parallel with T010 once submission format is stable.

### Dependencies

- Depends on WP01.

### Risks & Mitigations

- Risk: browser-side parsing diverges from server workflow validation.
- Mitigation: generate payload through shared serialization module or mirrored fixtures.

---

## Work Package WP03: Dual-Scanner Execution Engine (Priority: P1)

**Goal**: Process scan request issues and execute ALFA + axe for each valid target URL with resilient failure handling.
**Independent Test**: A valid scan issue triggers workflow execution; both tools run for each target; failures on one URL do not halt remaining scans.
**Prompt**: `/tasks/WP03-dual-scanner-execution-engine.md`

### Included Subtasks

- [ ] T011 Implement issue-event workflow entrypoint to parse request and initialize run metadata.
- [ ] T012 Integrate ALFA execution per URL with normalized success/failure status capture.
- [ ] T013 Integrate axe execution per URL with matching normalized status capture.
- [ ] T014 Implement per-URL fault isolation and continuation semantics.
- [ ] T015 Capture redirect information (submitted URL, final URL, redirected flag) in run data.
- [ ] T016 Add unit/integration tests for orchestrator behavior on mixed success/failure batches.

### Implementation Notes

- Keep tool adapters isolated so future scanner options can be added without changing orchestration core.
- Persist raw outputs alongside normalized summaries.

### Parallel Opportunities

- T012 and T013 can proceed in parallel once T011 and shared run model are in place.

### Dependencies

- Depends on WP01.

### Risks & Mitigations

- Risk: tool output incompatibility and transient runtime failures.
- Mitigation: normalize into stable internal schema with explicit error classification.

---

## Work Package WP04: Public Reporting and Pages Publishing (Priority: P2)

**Goal**: Build report generation and publishing pipeline for public per-run ALFA vs axe comparison artifacts.
**Independent Test**: Completed scan run publishes public Markdown/JSON outputs with issue linkage and per-URL comparison details.
**Prompt**: `/tasks/WP04-public-reporting-and-pages-publishing.md`

### Included Subtasks

- [ ] T017 Implement comparison builder for per-URL and aggregate ALFA/axe deltas.
- [ ] T018 Generate machine-readable run artifacts and human-readable summary outputs.
- [ ] T019 Implement Pages publishing workflow updates for report artifacts.
- [ ] T020 Maintain report index/history for discovering historical runs.
- [ ] T021 Add validation tests for report schema and public link integrity.

### Implementation Notes

- Ensure report model includes redirect details and source issue metadata.
- Keep output format stable and versioned.

### Parallel Opportunities

- T020 can proceed in parallel with T021 after artifact format is defined.

### Dependencies

- Depends on WP03.

### Risks & Mitigations

- Risk: broken public links and inconsistent report structure over time.
- Mitigation: index validation and schema checks in CI.

---

## Work Package WP05: Security and Operational Hardening (Priority: P2)

**Goal**: Enforce authenticated request controls, runtime safety checks, and observable operations.
**Independent Test**: Unauthorized or unsafe requests are rejected; private/internal targets are blocked; workflow logs and issue updates clearly explain outcomes.
**Prompt**: `/tasks/WP05-security-and-operational-hardening.md`

### Included Subtasks

- [ ] T022 Enforce authenticated submitter checks and scan-request issue eligibility rules.
- [ ] T023 Enforce runtime public URL policy with explicit private/internal block reasons.
- [ ] T024 Add abuse controls (concurrency keys, duplicate request handling, cancellation strategy).
- [ ] T025 Harden workflow permissions and token scopes to least privilege.
- [ ] T026 Add structured run diagnostics and issue status updates for operational traceability.

### Implementation Notes

- Security constraints must be validated server-side even if also validated in browser.
- Treat observability as product output for PoC trustworthiness.

### Parallel Opportunities

- T024 and T025 can run in parallel once workflow layout is stable.

### Dependencies

- Depends on WP03.

### Risks & Mitigations

- Risk: public workflow abuse or accidental over-privileged token usage.
- Mitigation: strict permission declarations and defensive request gating.

---

## Work Package WP06: End-to-End Verification and Release Readiness (Priority: P3)

**Goal**: Validate full flow from Pages intake to public report publication and document operational runbook.
**Independent Test**: End-to-end scenario executes with representative URL sets, meets performance expectations, and is documented for handoff.
**Prompt**: `/tasks/WP06-end-to-end-verification-and-readiness.md`

### Included Subtasks

- [ ] T027 Create end-to-end scenario tests (form input -> issue -> workflow -> report).
- [ ] T028 Run performance validation scenario for large batch (up to 100 URLs) and capture outcomes.
- [ ] T029 Align documentation/runbook with quickstart and real operational behavior.
- [ ] T030 Prepare demo dataset and acceptance verification checklist.

### Implementation Notes

- Use deterministic fixtures for repeatable runs.
- Explicitly validate success criteria coverage from spec.

### Parallel Opportunities

- T029 and T030 can proceed in parallel after test scenario baselines are available.

### Dependencies

- Depends on WP02, WP04, WP05.

### Risks & Mitigations

- Risk: final acceptance blocked by missing integration evidence.
- Mitigation: preserve execution logs and report links in verification outputs.

---

## Dependency & Execution Summary

- **Sequence**: WP01 -> (WP02, WP03) -> (WP04, WP05) -> WP06.
- **Parallelization**:
  - WP02 and WP03 can overlap after WP01.
  - WP04 and WP05 can overlap after WP03.
- **MVP Scope**: WP01 + WP02 + WP03 + minimal WP04 reporting path.

---

## Subtask Index (Reference)

| Subtask ID | Summary | Work Package | Priority | Parallel? |
|------------|---------|--------------|----------|-----------|
| T001 | Scaffold scanner project | WP01 | P0 | No |
| T002 | Define issue schema/parser | WP01 | P0 | No |
| T003 | URL validation + internal block | WP01 | P0 | Yes |
| T004 | Workflow shell + permissions | WP01 | P0 | Yes |
| T005 | Unit tests for guardrails | WP01 | P0 | No |
| T006 | Build Pages intake form | WP02 | P1 | No |
| T007 | Add max-100 validation | WP02 | P1 | No |
| T008 | Authenticated issue submission | WP02 | P1 | No |
| T009 | Input preview + rejection feedback | WP02 | P1 | Yes |
| T010 | Payload integration tests | WP02 | P1 | Yes |
| T011 | Issue-trigger workflow entry | WP03 | P1 | No |
| T012 | ALFA adapter integration | WP03 | P1 | Yes |
| T013 | axe adapter integration | WP03 | P1 | Yes |
| T014 | Per-URL failure isolation | WP03 | P1 | No |
| T015 | Redirect capture model | WP03 | P1 | No |
| T016 | Orchestrator tests | WP03 | P1 | No |
| T017 | Build comparison summaries | WP04 | P2 | No |
| T018 | Produce markdown/json artifacts | WP04 | P2 | No |
| T019 | Publish to Pages | WP04 | P2 | No |
| T020 | Historical run index | WP04 | P2 | Yes |
| T021 | Report schema/link tests | WP04 | P2 | Yes |
| T022 | Authenticated requester gating | WP05 | P2 | No |
| T023 | Runtime public URL enforcement | WP05 | P2 | No |
| T024 | Abuse/concurrency controls | WP05 | P2 | Yes |
| T025 | Least-privilege workflow perms | WP05 | P2 | Yes |
| T026 | Structured diagnostics + issue updates | WP05 | P2 | No |
| T027 | End-to-end flow tests | WP06 | P3 | No |
| T028 | 100-URL performance validation | WP06 | P3 | No |
| T029 | Runbook + quickstart sync | WP06 | P3 | Yes |
| T030 | Demo dataset + acceptance checklist | WP06 | P3 | Yes |