import * as inspector from "node:inspector";
export var Profiler;
(function (Profiler) {
    const session = new inspector.Session();
    session.connect();
    const cpu = new Promise((resolve) => session.post("Profiler.enable", () => resolve()));
    const heap = new Promise((resolve) => session.post("HeapProfiler.enable", () => resolve()));
    let CPU;
    (function (CPU) {
        async function start() {
            await cpu;
            return new Promise((resolve) => session.post("Profiler.start", () => resolve()));
        }
        CPU.start = start;
        async function stop() {
            await cpu;
            return new Promise((resolve, reject) => session.post("Profiler.stop", (err, { profile }) => err ? reject(err) : resolve(profile)));
        }
        CPU.stop = stop;
    })(CPU = Profiler.CPU || (Profiler.CPU = {}));
    let Heap;
    (function (Heap) {
        async function start() {
            await heap;
            return new Promise((resolve) => session.post("HeapProfiler.startSampling", () => resolve()));
        }
        Heap.start = start;
        async function stop() {
            await heap;
            return new Promise((resolve, reject) => session.post("HeapProfiler.stopSampling", (err, { profile }) => err ? reject(err) : resolve(profile)));
        }
        Heap.stop = stop;
    })(Heap = Profiler.Heap || (Profiler.Heap = {}));
})(Profiler || (Profiler = {}));
//# sourceMappingURL=profiler.js.map