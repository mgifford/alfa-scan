/// <reference types="node" />
import { Result, Err } from "@siteimprove/alfa-result";
/**
 * @public
 */
export var Interviewer;
(function (Interviewer) {
    async function load(name, defaultScope = "@siteimprove") {
        let scope;
        if (name.startsWith("@")) {
            const match = name.match(/^(@[^/]+)\/(.+)$/);
            if (match !== null) {
                scope = match[1];
                name = match[2];
            }
        }
        const patterns = [...candidates(name, scope)];
        if (scope === undefined) {
            patterns.push(...candidates(name, defaultScope));
            // For unscoped names, also attempt resolving the name as a file path to
            // allow loading local modules. This is only supported in Node.js and so
            // we lazily attempt importing the "path" module.
            try {
                const path = await import("path");
                patterns.push(path.resolve(name));
            }
            catch { }
        }
        for (const pattern of patterns) {
            try {
                const module = await import(pattern);
                return Result.of(module.default());
            }
            catch {
                continue;
            }
        }
        return Err.of(`No interviewer named "${name}" was found at:\n\n${patterns
            .map((pattern) => "  " + pattern)
            .join("\n")}`);
    }
    Interviewer.load = load;
})(Interviewer || (Interviewer = {}));
const prefix = "alfa-interviewer-";
function* candidates(name, scope) {
    scope = scope === undefined ? "" : scope + "/";
    if (!name.startsWith(prefix)) {
        yield scope + prefix + name;
    }
    yield scope + name;
}
//# sourceMappingURL=interviewer.js.map