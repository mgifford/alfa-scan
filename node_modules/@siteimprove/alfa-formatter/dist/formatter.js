import { Result, Err } from "@siteimprove/alfa-result";
/**
 * @public
 */
export var Formatter;
(function (Formatter) {
    async function load(name, defaultScope = "@siteimprove") {
        let scope;
        if (name.startsWith("@")) {
            const match = name.match(/^(@[^/]+)\/(.+)$/);
            if (match !== null) {
                scope = match[1];
                name = match[2];
            }
        }
        const patterns = [...candidates(name, scope)];
        if (scope === undefined) {
            patterns.push(...candidates(name, defaultScope));
        }
        for (const pattern of patterns) {
            try {
                const module = await import(pattern);
                return Result.of(module.default());
            }
            catch {
                continue;
            }
        }
        return Err.of(`No formatter named "${name}" was found at:\n\n${patterns
            .map((pattern) => "  " + pattern)
            .join("\n")}`);
    }
    Formatter.load = load;
})(Formatter || (Formatter = {}));
const prefix = "alfa-formatter-";
function* candidates(name, scope) {
    scope = scope === undefined ? "" : scope + "/";
    if (!name.startsWith(prefix)) {
        yield scope + prefix + name;
    }
    yield scope + name;
}
//# sourceMappingURL=formatter.js.map